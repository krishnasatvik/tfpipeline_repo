steps:
  - name: 'gcr.io/cloud-builders/git'
    args:
      - 'clone'
      - 'https://github.com/krishnasatvik/tfpipeline_repo.git'
      - '.'
      
  - name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        gcloud auth activate-service-account --key-file=private-key.json
        gcloud auth application-default login --project "tfpipeline" --quiet --no-user-output-enabled
        
  - name: 'hashicorp/terraform:latest'
    entrypoint: 'terraform'
    args:
      - 'init'

  - name: 'hashicorp/terraform:latest'
    entrypoint: 'terraform'
    args:
      - 'apply'
      - '-auto-approve'
